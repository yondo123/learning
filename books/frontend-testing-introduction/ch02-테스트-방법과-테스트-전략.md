#테스트 방법과 테스트 전략

## 테스트 레벨의 종류

### 정적 분석

타입 스크립트나 ESLint가 제공하는 기능을 활용

### 단위 테스트

**한 가지 모듈**에 한정하여 해당 모듈이 제공하는 기능을 검증하는 테스트 (독립된 환경에서 검증)

### 통합 테스트

모듈 조합으로 제공되는 기능을 검증하는 테스트

### E2E 테스트

Headless Browser 또는 UI 자동화 도구를 결합하여 검증하는 테스트 (광범위한 테스트)

## 테스트 목적

### 기능 테스트

흔히 프론트엔드에서 실행하는 기능 테스트는 인터랙션 테스트이다. 가상 브라우저를 통해 간단한 인터랙션 테스트, UI 자동화 도구를 사용해 브라우저 스토리지에 접근해 테스트도 가능하다.

### 비기능 테스트

다양한 검증 항목을 테스트할 수 있다. 대표적인 테스트에는 **접근성 테스트**가 있다. (시인성, a11y)
접근성 테스트 예시

- 체크 박스를 체크
- 오류 응답을 받았을 때 오류 문구 렌더링
- 접근성 위반 사례 검사

### 시각적 회귀 테스트

CSS는 UI 컴포넌트에 정의된 스타일뿐만 아니라 브라우저에 적용된 모든 스타일의 영향을 받는다.
시각적 회귀 테스트는 Headless Browser에 그려진 화면을 캡쳐해서 사용자 조작으로 변경된 화면 또는 초기 렌더링 화면과 이후 렌더링 화면 간 비교를 테스트할 수 있다.

## 테스트 전략 모델

테스트 행위는 팀 내에서 비용이 크게 발생하기 때문에 적절한 전략을 세워 분배를 계획해야한다.

### 아이스크림 콘

안티패턴으로 알려져있는 테스트 전략 모델이다.
외부 모듈의 의존성 때문에 불안정한 테스트가 많고 테스트가 통과되는 데 시간 비용이 많이 발생하게 되어 개발 흐름에 나쁜 영향을 줄 수 있다.

### 테스트 피라미드

아이스크림 콘 전략과 반대로 하층부 테스트 비중이 높은 전략 모델이다. 단위 테스트 비중이 높기 때문에 실행 속도가 빠르고 신속성이 높기 때문에 자주 실행할 수 있어 안정도가 높아진다.

### 테스팅 트로피

이 전략 모델의 핵심은 **통합 테스트 비중이 가장 높아야 한다**는 것이다. 테스팅 라이브러리와 가상 브라우저를 지원하는 도구(Jest 등)를 사용하면 Headless Browser 없이 사용자 조작을 재현해 테스트를 할 수 있어 실행 속도가 빠르면서도 실제 환경과 유사하게 테스트가 가능하다.

## 테스트 전략 계획

### 테스트가 없어 리팩토링이 불안한 경우

1. 릴리스된 기능을 목록으로 정리한다. (list-up)
2. 변경 전후로 결함이 발생하지 않았는지 검증하는 회귀 테스트를 진행한다. (안정성 높임)
3. 목 서버를 활용해 통합 테스트를 실시한다.
4. 통합 테스트가 늘어날수록 리팩토링할 수 있는 기능이 많아지기 때문에 점진적으로 테스트를 추가하면서 리팩토링을 실시하며 피라 테스트 피라미드 모델로 만든다.

### 반응형으로 제작된 프로젝트

반응협 웹은 테스팅 라이브러리만으로 스타일을 포함한 세밀한 테스트가 어렵다. 따라서 StoryBook을 활용해 시각적 회귀 테스트를 작성하는 것이 효율적이다.

### 데이터베이스를 포함한 E2E 테스트

실제 웹 API를 활용해 E2E테스트를 하고 싶다면 테스트용 스테이징 환경을 사용해야 한다.
